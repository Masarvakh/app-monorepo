(this.webpackJsonp=this.webpackJsonp||[]).push([[87],{4039:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"GasPanelRoutes",(function(){return r})),function(e){e.GasPanelModal="GasPanelModal"}(r||(r={}))},5302:function(e,t,n){"use strict";n.r(t);var r,o,i=n(51),c=n(57),s=n(50),l=n(77),a=n(41),u=n(354),d=n(2),f=n.n(d),b=n(4),p=n.n(b),j=n(1),O=n(44),m=n(88),y=n(36),g=n(17),v=n(24),h=n(187),w=n(86),x=[y.OnekeyNetwork.btc,y.OnekeyNetwork.eth,y.OnekeyNetwork.polygon],P=((r={})[y.OnekeyNetwork.btc]={supportOverview:!1,EIP1559Enabled:!1},r[y.OnekeyNetwork.eth]={supportOverview:!0,EIP1559Enabled:!0},r[y.OnekeyNetwork.polygon]={supportOverview:!0,EIP1559Enabled:!0},r),k=((o={})[y.OnekeyNetwork.eth]={low:0,stable:100,busy:200},o[y.OnekeyNetwork.polygon]={low:0,stable:200,busy:300},o),I=n(11),N=n(1091),S=n(62),E=n(3),_=n.n(E),D=n(15),F=n.n(D),M=n(21),B=n.n(M),T=n(598),C=n(1021),G=n(1529),A=n(924),L=n(0),R=["selectedNetworkId","gasInfo","isEIP1559Enabled"];function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J={marginTop:4,paddingLeft:"0px",paddingRight:"0px",paddingTop:"4px",paddingBottom:"4px",alignItems:"center",height:"48px",bgColor:"transparent"};function V(e,t){return t?e:"object"===typeof e?null!=(n=e.gasPrice)?n:e.price:e;var n}function W(e){var t=e.selectedNetworkId,n=e.gasInfo,r=e.isEIP1559Enabled,o=F()(e,R),i=(n||{}).prices,c=g.default.serviceGas,u=Object(j.useState)([]),d=p()(u,2),b=d[0],O=d[1],m=Object(v.useNetworkSimple)(t),h=null==m?void 0:m.settings.isBtcForkChain,w=Object(j.useMemo)((function(){var e;if(!i||!m)return[];var n=String(null!=(e=null==m?void 0:m.settings.minGasLimit)?e:21e3),o={prices:i,defaultPresetIndex:"1",eip1559:r&&!h,limit:n=h?"340":n,feeDecimals:m.feeDecimals,nativeDecimals:m.decimals,isBtcForkChain:h,feeList:h?i.map((function(e){return new B.a(e).times(n).shiftedBy(m.decimals).toNumber()})).filter(Boolean):[]};return i.map((function(e,c){return U({value:c.toString(),title:Object(L.jsx)(T.FeeSpeedLabel,{index:c,iconSize:28,space:2,prices:i}),describe:Object(L.jsxs)(a.default,{space:"10px",alignItems:"center",children:[Object(L.jsxs)(S.default,{children:[Object(L.jsx)(A.SendEditFeeOverview,{accountId:"",networkId:t,price:V(e,r&&!h),feeInfo:o,limit:n,currencyProps:{typography:"Body1",textAlign:"right"},formatOptions:{fixed:t===y.OnekeyNetwork.polygon?4:2},onlyCurrency:!0}),Object(L.jsx)(C.FeeSpeedTime,{index:c,waitingSeconds:b[c]})]}),Object(L.jsx)(G.FeeSpeedTip,{index:c,isEIP1559:r&&!h,price:V(e,r&&!h),limit:n,feeInfo:o})]})},J)}))}),[h,r,m,i,t,b]);return Object(j.useEffect)((function(){(function(){var e=f()((function*(){var e=yield c.getTxWaitingSeconds({networkId:t});O(e)}));return function(){return e.apply(this,arguments)}})()()}),[t,c]),Object(L.jsx)(I.default,U(U({},o),{},{children:n?Object(L.jsx)(N.default,{mt:2,padding:"0px",items:w,name:"standard fee group"}):Object(L.jsx)(s.default,{w:"full",py:16,children:Object(L.jsx)(l.default,{size:"lg"})})}))}var q,H=n(20),K=n(457),Q=n.n(K),X=n(13),Y=n.n(X),Z=n(2424),$=n(198),ee=n(120),te=["gasInfo","selectedNetworkId","isEIP1559Enabled"];function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.low="low",e.stable="stable",e.busy="busy"}(q||(q={}));var oe=["\ud83c\udf43","\u2615\ufe0f","\ud83d\udd25"];function ie(e){var t=e.gasInfo,n=e.selectedNetworkId,r=e.isEIP1559Enabled,o=F()(e,te),i=t||{},c=i.estimatedTransactionCount,s=i.networkCongestion,l=i.prices,u=Object(m.default)(),d=Object(v.useActiveWalletAccount)().accountId,f=Object(v.useNetworkSimple)(n),b=Object(j.useMemo)((function(){if(r&&f){var e,t,n=(null==l?void 0:l.length)||1,o=M.BigNumber.sum.apply(M.BigNumber,Y()(Q()(l,"baseFee"))).dividedBy(n).toFixed(),i=M.BigNumber.sum.apply(M.BigNumber,Y()(Q()(l,"maxFeePerGas"))).dividedBy(n).toFixed(),c=M.BigNumber.sum.apply(M.BigNumber,Y()(Q()(l,"maxPriorityFeePerGas"))).dividedBy(n).toFixed(),s=String(f.settings.minGasLimit||21e3),a=Object($.calculateTotalFeeRange)({eip1559:!0,price1559:{baseFee:o,maxFeePerGas:i,maxPriorityFeePerGas:c},limit:s}).max;return new M.BigNumber(a).shiftedBy(null!=(e=f.feeDecimals)?e:0).shiftedBy(-(null!=(t=f.decimals)?t:0)).toFixed(8)}return"0"}),[r,f,l]);if(!t)return null;if(void 0===s&&void 0===c)return null;var p=q.stable;s?p=function(e){return e<Z.NetworkCongestionThresholds.stable?q.low:e>=Z.NetworkCongestionThresholds.stable&&e<Z.NetworkCongestionThresholds.busy?q.stable:q.busy}(s):c&&(p=function(e){var t=e.estimatedTransactionCount,n=e.networkId;return t<k[n].stable?q.low:t>=k[n].stable&&t<k[n].busy?q.stable:q.busy}({estimatedTransactionCount:c,networkId:n}));var O=function(e){switch(e){case q.low:return{label:oe[0]};case q.stable:return{label:oe[1]};case q.busy:return{label:oe[2]};default:return{label:oe[1]}}}(p);return Object(L.jsxs)(I.default,re(re({},o),{},{children:[Object(L.jsx)(H.default,{fontSize:56,textAlign:"center",children:O.label}),Object(L.jsx)(H.default,{typography:"DisplayMedium",textAlign:"center",children:u.formatMessage({id:"title__current_gas_fee"})}),r?Object(L.jsxs)(a.default,{alignItems:"center",mt:1,justifyContent:"center",children:[Object(L.jsxs)(H.default,{color:"text-subdued",children:[" ",u.formatMessage({id:"form__max_fee"}),":"]}),Object(L.jsx)(ee.FormatCurrencyNativeOfAccount,{networkId:n,accountId:d,value:b,formatOptions:{fixed:4},render:function(e){return Object(L.jsx)(H.default,{color:"text-subdued",children:e})}}),Object(L.jsx)(H.default,{color:"text-subdued",children:"("+b+" "+((null==f?void 0:f.symbol)||"")+")"})]}):Object(L.jsx)(H.default,{typography:"Body2",mt:1,color:"text-subdued",textAlign:"center",children:u.formatMessage({id:"title__current_gas_fee_desc"},{0:(null==f?void 0:f.symbol)||""})})]}))}var ce=n(100),se=["leftSeconds","setLeftSeconds"];function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue=null,de=function(e){return Object(L.jsx)(H.default,{color:"text-success",children:e})};function fe(e){var t=e.leftSeconds,n=e.setLeftSeconds,r=F()(e,se),o=Object(m.default)();return Object(j.useEffect)((function(){return 6===t&&ue&&clearTimeout(ue),ue=setInterval((function(){var e=t-1;e<0&&(e=0),n(e)}),1e3),function(){ue&&clearTimeout(ue)}}),[t,n]),Object(L.jsxs)(I.default,ae(ae({},r),{},{children:[Object(L.jsx)(ce.default,{}),Object(L.jsx)(H.default,{color:"text-subdued",textAlign:"center",mt:4,children:o.formatMessage({id:"content__gas_fee_will_automatically_update_after_str"},{0:o.formatMessage({id:"content__str_seconds_plural"},{0:t}),a:de})})]}))}var be=n(630),pe=n(61),je=n(38),Oe=n(121);function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ge(e){var t=e.selectedNetworkId,n=e.setSelectedNetworkId,r=Object(v.useManageNetworks)().allNetworks,o=Object(j.useMemo)((function(){return r.filter((function(e){return x.includes(e.id)}))}),[r]),i=Object(v.useNetworkSimple)(t),c=Object(j.useMemo)((function(){return{label:null==i?void 0:i.name,value:null==i?void 0:i.id,tokenProps:{token:{logoURI:null==i?void 0:i.logoURI,name:null==i?void 0:i.shortName}},badge:"evm"===(null==i?void 0:i.impl)?"EVM":void 0}}),[null==i?void 0:i.id,null==i?void 0:i.impl,null==i?void 0:i.logoURI,null==i?void 0:i.name,null==i?void 0:i.shortName]);return Object(L.jsx)(be.default,{w:"190",trigger:function(e){return Object(L.jsx)(pe.default,ye(ye({accessibilityLabel:"More options menu"},e),{},{children:Object(L.jsxs)(a.default,{alignItems:"center",space:3,children:[Object(L.jsx)(Oe.default,ye({size:6},c.tokenProps)),Object(L.jsx)(H.default,{typography:"Body1",children:null==i?void 0:i.name}),Object(L.jsx)(je.default,{size:20,name:"ChevronDownMini",color:"icon-subdued"})]})}))},children:o.map((function(e){return Object(L.jsx)(be.default.Item,{onPress:function(){return n(e.id)},children:Object(L.jsxs)(a.default,{space:4,alignItems:"center",children:[Object(L.jsx)(I.default,{width:"20px",children:t===e.id&&Object(L.jsx)(je.default,{name:"CheckMini",size:20,color:"interactive-default"})}),Object(L.jsx)(H.default,{typography:"Body1",children:e.name})]})},e.id)}))})}var ve=y.OnekeyNetwork.eth,he=null;var we=n(4039),xe=n(237),Pe=Object(xe.default)(),ke=[{name:we.GasPanelRoutes.GasPanelModal,component:function(){var e,t=Object(m.default)(),n=Object(O.useRoute)(),r=Object(j.useRef)(""),o=n.params.networkId,i=void 0===o?"":o,d=Object(h.appSelector)((function(e){return e.settings})).selectedFiatMoneySymbol,b=Object(j.useState)(x.includes(i)?i:ve),y=p()(b,2),k=y[0],I=y[1],N=Object(j.useState)(!1),S=p()(N,2),E=S[0],_=S[1],D=Object(j.useState)(null),F=p()(D,2),M=F[0],B=F[1],T=Object(j.useState)(6),C=p()(T,2),G=C[0],A=C[1],R=Object(v.useSettings)(),z=Object(v.useNativeToken)(k),U=g.default.serviceGas,J=Object(j.useMemo)((function(){return!(!M||!M.prices[0])&&("object"===typeof M.prices[0]&&"maxFeePerGas"in M.prices[0]&&"maxPriorityFeePerGas"in M.prices[0])}),[M]),V=null==(e=null==R?void 0:R.gasPanelEIP1559Enabled)||e,q=Object(j.useCallback)((function(e){g.default.dispatch(Object(w.setGasPanelEIP1559Enabled)(e))}),[]);return Object(j.useEffect)((function(){B(null),he&&clearTimeout(he);var e=function(){var t=f()((function*(){var t=Math.random().toString();r.current=t;var n=yield U.getGasInfo({networkId:k});5===n.prices.length&&(n.prices=[n.prices[0],n.prices[2],n.prices[4]]),t===r.current&&(B(n),_(!0),he=setTimeout((function(){return e()}),6e3),A(6))}));return function(){return t.apply(this,arguments)}}();return e(),function(){he&&clearTimeout(he)}}),[k,U]),Object(j.useEffect)((function(){i&&x.includes(i)&&I(i)}),[i]),Object(j.useEffect)((function(){var e;g.default.servicePrice.fetchSimpleTokenPrice({networkId:k,tokenIds:[null!=(e=null==z?void 0:z.tokenIdOnNetwork)?e:""],vsCurrency:d})}),[i,d,k,null==z?void 0:z.tokenIdOnNetwork]),Object(L.jsx)(c.default,{header:t.formatMessage({id:"content__gas_fee"}),height:"560px",hideSecondaryAction:!0,onPrimaryActionPress:function(e){return(0,e.close)()},primaryActionProps:{type:"primary"},primaryActionTranslationId:"action__i_got_it",scrollViewProps:{children:E?Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)(a.default,{justifyContent:"space-between",alignItems:"center",children:[Object(L.jsx)(ge,{selectedNetworkId:k,setSelectedNetworkId:I}),J&&P[k].EIP1559Enabled?Object(L.jsx)(u.default,{onToggle:function(){q(!V)},isChecked:V,label:"EIP 1559",size:"mini"}):null]}),P[k].supportOverview?Object(L.jsx)(ie,{mt:8,gasInfo:M,isEIP1559Enabled:V,selectedNetworkId:k}):null,Object(L.jsx)(W,{mt:6,gasInfo:M,isEIP1559Enabled:V,selectedNetworkId:k}),M?Object(L.jsx)(fe,{mt:12,leftSeconds:G,setLeftSeconds:A}):null]}):Object(L.jsx)(s.default,{w:"full",py:10,children:Object(L.jsx)(l.default,{size:"lg"})})}})}}];t.default=function(){var e=Object(i.default)();return Object(L.jsx)(Pe.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!e},children:ke.map((function(e){return Object(L.jsx)(Pe.Screen,{name:e.name,component:e.component},e.name)}))})}}}]);