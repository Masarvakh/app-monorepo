(this.webpackJsonp=this.webpackJsonp||[]).push([[84],{4325:function(e,t,a){"use strict";a.r(t),a.d(t,"useAddressBook",(function(){return B}));var n=a(57),r=a(263),s=a(50),d=a(190),o=a(78),c=a(204),i=a(90),u=a(11),l=a(27),f=a(48),b=a(302),j=a(1),m=a(44),O=a(88),p=a(218),h=a(24),g=a(16),v=a(1070),_=a(3),x=a.n(_),y=a(15),w=a.n(y),k=a(17),C=a(1079),A=a(193),M=a(0),P=["contact"];function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var I=function(e){var t=e.contact,a=w()(e,P),n=Object(O.default)(),r=t.name,s=t.address,d=t.networkId,o=t.id,c=Object(m.useNavigation)(),i=Object(j.useCallback)((function(){c.navigate(g.RootRoutes.Modal,{screen:g.ModalRoutes.AddressBook,params:{screen:v.AddressBookRoutes.EditAddressRoute,params:{uuid:o,defaultValues:{name:r,address:s,networkId:d}}}})}),[c,r,s,d,o]),u=Object(j.useCallback)((function(){setTimeout((function(){Object(p.copyToClipboard)(s),f.default.show({title:n.formatMessage({id:"msg__address_copied"})})}),200)}),[n,s]),l=Object(j.useCallback)((function(){k.default.dispatch(Object(C.remove)({uuid:o})),f.default.show({title:n.formatMessage({id:"msg__address_deleted"})})}),[o,n]),b=Object(j.useMemo)((function(){return[{id:"action__edit",onPress:i,icon:"PencilMini"},{id:"action__copy_address",onPress:u,icon:"Square2StackOutline"},{id:"action__delete",onPress:l,icon:"TrashMini",variant:"desctructive"}]}),[u,l,i]);return Object(M.jsx)(A.default,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){x()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({w:190,options:b},a))},R=function(e){var t=e.networkId,a=e.onNew,n=e.onSelected,g=Object(O.default)(),v=Object(h.useAppSelector)((function(e){return e.contacts.contacts})),_=Object(b.default)().bottom,x=Object(j.useMemo)((function(){var e=Object.values(v);if(e=e.sort((function(e,t){return e.createAt,t.createAt,-1})),t){var a=t.split("--")[0];e=e.filter((function(e){return e.badge.toUpperCase()===a.toUpperCase()}))}return e}),[v,t]),y=Object(j.useCallback)((function(e){Object(p.copyToClipboard)(e),f.default.show({title:g.formatMessage({id:"msg__address_copied"})})}),[g]),w=Object(m.useNavigation)(),k=Object(j.useCallback)((function(e){n&&(null==n||n({address:e.address,name:e.name}),w.goBack())}),[n,w]),C=Object(j.useCallback)((function(e){var t=e.item,a=t.name,n=t.badge,r=t.address;return Object(M.jsxs)(i.default,{onLongPress:function(){y(r)},onPress:function(){return k(t)},children:[Object(M.jsx)(i.default.Column,{children:Object(M.jsx)(u.default,{w:"40px",h:"40px",borderRadius:"full",bg:"decorative-surface-one",justifyContent:"center",alignItems:"center",children:Object(M.jsx)(l.default.Body2,{color:"decorative-icon-one",children:a.toUpperCase()[0]})})}),Object(M.jsx)(i.default.Column,{flex:1,text:{label:Object(M.jsxs)(u.default,{flexDirection:"row",alignItems:"center",children:[Object(M.jsx)(l.default.Body1Strong,{mr:"8px",isTruncated:!0,children:a}),Object(M.jsx)(c.default,{size:"sm",title:n.toUpperCase()})]}),description:Object(M.jsx)(l.default.Body2,{color:"text-subdued",children:r})}}),Object(M.jsx)(i.default.Column,{children:Object(M.jsx)(I,{contact:t,children:Object(M.jsx)(o.default,{name:"EllipsisVerticalMini",circle:!0,type:"plain"})})})]})}),[y,k]);return 0===x.length?Object(M.jsx)(s.default,{w:"full",h:"full",children:Object(M.jsx)(d.default,{title:g.formatMessage({id:"title__no_cantact"}),subTitle:g.formatMessage({id:"title__no_cantact_desc"}),actionTitle:g.formatMessage({id:"action__add_new_address"}),actionProps:{leftIconName:"PlusMini"},handleAction:a,emoji:"\ud83d\udcc7"})}):Object(M.jsx)(r.default,{data:x,renderItem:C,keyExtractor:function(e){return String(e.id)},ListFooterComponent:_>0?Object(M.jsx)(u.default,{h:_+"px"}):null})};function B(){var e=Object(m.useNavigation)();return{showAddressBookModal:Object(j.useCallback)((function(t){e.navigate(g.RootRoutes.Modal,{screen:g.ModalRoutes.AddressBook,params:{screen:v.AddressBookRoutes.NewPickAddressRoute,params:t}})}),[e])}}t.default=function(){var e,t=Object(O.default)(),a=null!=(e=Object(m.useRoute)().params)?e:{},r=a.networkId,s=a.onSelected,d=Object(m.useNavigation)(),c=Object(j.useCallback)((function(){d.navigate(v.AddressBookRoutes.NewAddressRoute)}),[d]);return Object(M.jsx)(n.default,{rightContent:Object(M.jsx)(o.default,{onPress:c,name:"PlusCircleOutline",type:"plain",size:"lg",circle:!0}),header:t.formatMessage({id:"title__contacts"}),hideSecondaryAction:!0,footer:null,height:"480px",children:Object(M.jsx)(R,{networkId:r,onSelected:s,onNew:c})})}},5306:function(e,t,a){"use strict";a.r(t);var n=a(51),r=a(48),s=a(1),d=a(44),o=a(88),c=a(17),i=a(47),u=a(1079),l=a(3),f=a.n(l),b=a(57),j=a(11),m=a(46),O=a(2),p=a.n(O),h=a(126),g=a(15),v=a.n(g),_=a(795),x=a(1092),y=a(1156),w=a(24),k=a(0),C=["defaultValues","header","showAlert","onSubmit","editing"];function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var M=function(e){var t=e.defaultValues,a=e.header,r=(e.showAlert,e.onSubmit),d=e.editing,i=v()(e,C),u=Object(o.default)(),l=Object(s.useRef)(),O=Object(w.useAppSelector)((function(e){return e.contacts.contacts})),g=Object(s.useMemo)((function(){return new Map(Object.values(O).map((function(e){return[e.address.toLowerCase(),e]})))}),[O]),M=Object(h.default)({defaultValues:t,mode:"onChange"}),P=M.control,S=M.handleSubmit,I=M.setValue,R=M.watch,B=M.trigger,N=M.formState.isValid,E=R("name"),T=R("address"),D=R("networkId"),V=Object(n.default)(),L=Object(_.useNameServiceStatus)(),q=L.onChange,U=L.disableSubmitBtn,F=L.address,z=L.name,H=Object(w.useDebounce)(T,300),W=F||H;Object(s.useEffect)((function(){function e(){return(e=p()((function*(){if(W&&D)try{yield c.default.validator.validateAddress(D,W.trim()),l.current=!1,B("address")}catch(e){l.current=!0,B("address")}}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[W,D,B,u]),Object(s.useEffect)((function(){E.length>24&&I("name",E.slice(0,24)),z&&!E&&I("name",z)}),[E,I,z]),Object(s.useEffect)((function(){T.length>103&&I("address",T.slice(0,103))}),[T,I]);var J=Object(s.useCallback)((function(e){q(e),B("address")}),[B,q]),G=Object(s.useCallback)((function(e){return Object(k.jsx)(_.default,{name:e,onChange:J,disableBTC:!1,networkId:D})}),[J,D]);return Object(k.jsx)(b.default,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){f()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({header:a,hideSecondaryAction:!0,primaryActionProps:{isDisabled:!N||U,onPress:function(){return S((function(e){return!U&&F&&(e.address=F),r(e)}))()}},scrollViewProps:{children:Object(k.jsx)(j.default,{w:"full",h:"full",children:Object(k.jsxs)(m.default,{children:[Object(k.jsx)(y.default,{hideHelpText:!0,control:P,name:"networkId"}),Object(k.jsx)(m.default.Item,{control:P,name:"name",label:u.formatMessage({id:"form__contact_name"}),rules:{required:{value:!0,message:u.formatMessage({id:"form__field_is_required"})}},children:Object(k.jsx)(m.default.Input,{size:V?"xl":"default"})}),Object(k.jsx)(m.default.Item,{control:P,name:"address",label:u.formatMessage({id:"form__address"}),helpText:G,rules:{required:{value:!0,message:u.formatMessage({id:"form__field_is_required"})},validate:function(e){var a=(null==F?void 0:F.toLowerCase())||(null==e?void 0:e.toLowerCase()),n=t.address.toLowerCase();if(a)return!d&&g.get(a)||d&&g.get(a)&&a!==n?u.formatMessage({id:"msg__this_address_already_exists"}):l.current?u.formatMessage({id:"form__address_invalid"}):void 0}},children:Object(k.jsx)(x.default,{})})]})})}},i))},P=function(){var e=Object(o.default)(),t=Object(d.useNavigation)(),a=Object(d.useRoute)(),n=Object(i.useNetworks)(),l=a.params,f=l.defaultValues,b=l.uuid,j=Object(s.useCallback)((function(a){var s=n.find((function(e){return e.id===a.networkId}));s&&(c.default.dispatch(Object(u.update)({uuid:b,contact:{name:a.name,address:a.address,badge:s.impl,networkId:s.id}})),c.default.serviceCloudBackup.requestBackup(),r.default.show({title:e.formatMessage({id:"msg__address_changed"})}),t.goBack())}),[n,t,b,e]);return Object(k.jsx)(M,{defaultValues:{address:f.address,name:f.name,networkId:f.networkId},onSubmit:j,header:e.formatMessage({id:"title__edit_address"}),primaryActionTranslationId:"action__save",editing:!0})},S=function(){var e,t=Object(o.default)(),a=Object(d.useNavigation)(),n=null!=(e=Object(d.useRoute)().params)?e:{},i=n.onSelected,u=n.networkId,l=n.defaultAddress,f=Object(h.default)({defaultValues:{address:null!=l?l:""},mode:"onChange"}),j=f.control,O=f.watch,g=f.trigger,v=f.setError,_=f.setValue,y=f.handleSubmit,C=f.formState.isValid,A=Object(w.useDebounce)(O("address"),300);Object(s.useEffect)((function(){function e(){return(e=p()((function*(){if(A&&u)try{yield c.default.validator.validateAddress(u,A.trim()),g("address")}catch(e){v("address",{message:t.formatMessage({id:"form__address_invalid"})})}}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[A,u,g,v,t]);var M=Object(s.useCallback)(function(){var e=p()((function*(e){if(u)try{yield c.default.validator.validateAddress(u,e.address.trim())}catch(n){return void r.default.show({title:t.formatMessage({id:"form__address_invalid"})})}null==i||i({address:e.address.trim(),name:e.name}),a.goBack()}));return function(t){return e.apply(this,arguments)}}(),[a,i,t,u]);return Object(k.jsx)(b.default,{header:t.formatMessage({id:"form__enter_address"}),hideSecondaryAction:!0,primaryActionTranslationId:"action__confirm",primaryActionProps:{isDisabled:!C,onPress:function(){return y(M)()}},children:Object(k.jsx)(m.default.Item,{control:j,name:"address",rules:{required:{value:!0,message:t.formatMessage({id:"form__field_is_required"})}},children:Object(k.jsx)(x.default,{networkId:u,onChangeAddressName:function(e){return _("name",e)},plugins:["contact","paste","scan"]})})})},I=a(4325),R=function(){var e=Object(o.default)(),t=Object(d.useNavigation)(),a=(Object(d.useRoute)().params||{}).address,n=void 0===a?"":a,l=Object(i.useNetworks)(),f=Object(s.useCallback)(function(){var a=p()((function*(a){var n=l.find((function(e){return e.id===a.networkId}));if(a.networkId)try{yield c.default.validator.validateAddress(a.networkId,a.address)}catch(s){return void r.default.show({title:e.formatMessage({id:"form__address_invalid"})})}n&&(c.default.dispatch(Object(u.create)({name:a.name,address:a.address,badge:n.impl,networkId:n.id})),c.default.serviceCloudBackup.requestBackup(),r.default.show({title:e.formatMessage({id:"msg__address_added"})},{}),t.goBack())}));return function(e){return a.apply(this,arguments)}}(),[l,t,e]);return Object(k.jsx)(M,{defaultValues:{address:n,name:""},onSubmit:f,header:e.formatMessage({id:"action__add_new_address"}),showAlert:!0,primaryActionTranslationId:"action__add"})},B=a(411),N=a(570),E=a(13),T=a.n(E),D=a(473),V=a(50),L=a(190),q=a(61),U=a(204),F=a(27),z=a(4),H=a.n(z),W=a(100),J=a(107),G=a(79),K=a(163),Q=a(475),X=a(1070),Y=function(){return Object(k.jsx)(j.default,{mx:{base:4,md:6},children:Object(k.jsx)(W.default,{})})},Z=function(e){var t,a=e.addressFilter,n=Object(o.default)(),r=Object(d.useNavigation)(),c=null!=(t=Object(d.useRoute)().params)?t:{},i=c.networkId,u=c.onSelected,l=Object(w.useAppSelector)((function(e){return e.contacts.contacts})),f=Object(s.useState)([]),b=H()(f,2),m=b[0],O=b[1],h=Object(s.useCallback)(function(){var e=p()((function*(e){if(a){var t=e.map(function(){var e=p()((function*(e){return{value:e,isVaild:yield a(e.address)}}));return function(t){return e.apply(this,arguments)}}());return(yield Promise.all(t)).filter((function(e){return e.isVaild})).map((function(e){return e.value}))}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),[a]);Object(s.useEffect)((function(){function e(){return(e=p()((function*(){var e=Object.values(l);if(e=e.sort((function(e,t){return e.createAt,t.createAt,-1})),i){var t=i.split("--")[0];e=e.filter((function(e){return e.badge.toUpperCase()===t.toUpperCase()}))}(e=yield h(e))&&e.length>0&&O(e)}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[l,h,i]);var g=Object(s.useCallback)((function(e){null==u||u({address:e.address,name:e.name}),r.goBack()}),[u,r]),v=Object(s.useCallback)((function(e){var t=e.item,a=e.index;return Object(k.jsxs)(q.default,{py:"4",px:"4",mx:{base:4,md:6},flexDirection:"row",alignItems:"center",bg:"surface-default",borderTopRadius:0===a?"12":void 0,borderBottomRadius:a===m.length-1?"12":void 0,onPress:function(){return g(t)},children:[Object(k.jsx)(j.default,{w:"8",h:"8",borderRadius:"full",bg:"decorative-surface-one",justifyContent:"center",alignItems:"center",children:Object(k.jsx)(F.default.DisplaySmall,{color:"decorative-icon-one",children:t.name.toUpperCase()[0]})}),Object(k.jsxs)(j.default,{flex:"1",ml:"4",children:[Object(k.jsxs)(j.default,{flexDirection:"row",children:[Object(k.jsx)(F.default.Body1Strong,{mr:"2",numberOfLines:1,maxWidth:"80%",children:t.name}),Object(k.jsx)(U.default,{size:"sm",title:t.badge.toUpperCase()})]}),Object(k.jsx)(j.default,{children:Object(k.jsx)(F.default.Body2,{color:"text-subdued",numberOfLines:2,children:t.address})})]})]})}),[m,g]),_=Object(s.useMemo)((function(){return Object(k.jsx)(V.default,{w:"full",h:"full",children:Object(k.jsx)(L.default,{title:n.formatMessage({id:"title__no_cantact"}),subTitle:n.formatMessage({id:"title__no_cantact_desc"}),emoji:"\ud83d\udcc7"})})}),[n]);return Object(k.jsx)(D.default,{ListEmptyComponent:_,data:m,ItemSeparatorComponent:Y,renderItem:v,keyExtractor:function(e){return e.address}})},$=function(e){var t,a=e.addressFilter,n=Object(o.default)(),r=Object(i.useRuntime)().wallets,u=Object(d.useNavigation)(),l=null!=(t=Object(d.useRoute)().params)?t:{},f=l.networkId,b=l.onSelected,m=Object(s.useState)([]),O=H()(m,2),h=O[0],g=O[1],v=Object(s.useCallback)(function(){var e=p()((function*(e){if(a){var t=e.map(function(){var e=p()((function*(e){return{value:e,isVaild:yield a(e.address)}}));return function(t){return e.apply(this,arguments)}}());return(yield Promise.all(t)).filter((function(e){return e.isVaild})).map((function(e){return e.value}))}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),[a]);Object(s.useEffect)((function(){function e(){return(e=p()((function*(){for(var e=function*(){var e=r[t],a=yield c.default.engine.getAccounts(e.accounts,f);(a=yield v(a))&&a.length>0&&g((function(t){return[].concat(T()(t),[{wallet:e,data:a,key:e.id}])}))},t=0;t<r.length;t+=1)yield*e()}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[v]);var _=Object(s.useCallback)((function(e){null==b||b({address:e.address,name:e.name}),u.goBack()}),[b,u]),x=Object(s.useCallback)((function(e){return"external"===e.type?n.formatMessage({id:"content__external_account"}):"imported"===e.type?n.formatMessage({id:"wallet__imported_accounts"}):"watching"===e.type?n.formatMessage({id:"wallet__watched_accounts"}):e.name}),[n]);return Object(k.jsx)(N.default,{stickySectionHeadersEnabled:!1,sections:h,contentContainerStyle:{flexGrow:1},keyExtractor:function(e,t){return""+e.address+t},renderItem:function(e){var t=e.item,a=e.section,n=e.index;return Object(k.jsxs)(q.default,{flexDirection:"row",p:"4",bg:"surface-default",mx:{base:4,md:6},borderTopLeftRadius:0===n?"12":void 0,borderTopRightRadius:0===n?"12":void 0,borderBottomLeftRadius:n===a.data.length-1?"12":void 0,borderBottomRightRadius:n===a.data.length-1?"12":void 0,onPress:function(){return _({address:t.address,name:t.name})},alignItems:"center",children:[Object(k.jsx)(j.default,{mr:"3",children:Object(k.jsx)(Q.default,{avatar:a.wallet.avatar,walletImage:a.wallet.type,hwWalletType:a.wallet.deviceType||Object(G.getDeviceTypeByDeviceId)(a.wallet.associatedDevice),isPassphrase:Object(K.isPassphraseWallet)(a.wallet),size:"sm"})},t.address),Object(k.jsxs)(j.default,{flex:"1",children:[Object(k.jsx)(F.default.Body1Strong,{color:"text-default",numberOfLines:1,children:t.name}),Object(k.jsx)(F.default.Body2,{color:"text-subdued",children:Object(J.shortenAddress)(t.address)})]})]})},ItemSeparatorComponent:Y,renderSectionHeader:function(e){var t=e.section;return Object(k.jsx)(F.default.Subheading,{my:"2",mx:{base:4,md:6},children:x(t.wallet)})}})},ee=function(){var e,t=Object(o.default)(),a=null!=(e=Object(d.useRoute)().params)?e:{},n=a.addressFilter,r=a.contactExcludeWalletAccount,c=Object(s.useState)(0),i=H()(c,2),u=i[0],l=i[1],f=Object(d.useNavigation)(),m=Object(s.useCallback)((function(){f.navigate(X.AddressBookRoutes.NewAddressRoute)}),[f]),O=Object(s.useMemo)((function(){return Object(k.jsx)($,{addressFilter:n})}),[n]),p=Object(s.useMemo)((function(){return Object(k.jsx)(Z,{addressFilter:n})}),[n]);return Object(k.jsxs)(b.default,{header:t.formatMessage({id:"title__select_contact"}),hideSecondaryAction:!0,footer:0===u?void 0:null,primaryActionTranslationId:"action__add_new_address",primaryActionProps:{leftIconName:"PlusMini",type:"basic",onPress:m},maxHeight:"560px",hidePrimaryAction:0!==u,staticChildrenProps:{flex:1,py:6},children:[Object(k.jsx)(j.default,{mb:"6",px:{base:4,md:6},children:r?null:Object(k.jsx)(B.default,{values:[t.formatMessage({id:"title__address_book"}),t.formatMessage({id:"form__my_wallet"})],selectedIndex:u,onChange:l})}),Object(k.jsx)(j.default,{flex:"1",children:0===u?p:O})]})},te=a(237),ae=Object(te.default)(),ne=[{name:X.AddressBookRoutes.NewAddressRoute,component:R},{name:X.AddressBookRoutes.PickAddressRoute,component:ee},{name:X.AddressBookRoutes.EditAddressRoute,component:P},{name:X.AddressBookRoutes.EnterAddressRoute,component:S},{name:X.AddressBookRoutes.NewPickAddressRoute,component:I.default}];t.default=function(){var e=Object(n.default)();return Object(k.jsx)(ae.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!e},children:ne.map((function(e){return Object(k.jsx)(ae.Screen,{name:e.name,component:e.component},e.name)}))})}}}]);